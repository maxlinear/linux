# SPDX-License-Identifier: (GPL-2.0 OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/phy/intel,combo-phy.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: MaxLinear ComboPhy Subsystem for LGM C-step

description: |
  MaxLinear Combophy subsystem supports PHYs for PCIe, EMAC and SATA
  controllers. A single Combophy provides two PHY instances.

properties:
  $nodename:
    pattern: "combophy(@.*|-[0-9a-f])*$"

  compatible:
    items:
      - const: mxl,combo-phy-lgmc

  clocks:
    maxItems: 1

  resets:
    maxItems: 2

  reset-names:
    items:
      - const: combo
      - const: phy

  intel,syscfg:
    $ref: /schemas/types.yaml#/definitions/phandle-array
    description: Chip configuration registers handle and ComboPhy instance id

  intel,hsio:
    $ref: /schemas/types.yaml#/definitions/phandle-array
    description: HSIO registers handle and ComboPhy instance id on NOC

  intel,bid:
    description: HSIO bus id

  intel,epu-idx:
    description: epu index to notify

required:
  - compatible
  - clocks
  - resets
  - reset-names
  - intel,syscfg
  - intel,hsio
  - intel,bid

examples:
  - |
    #include <dt-bindings/phy/phy.h>
    cb0phy0_cr: cbphy-app@d0a00000 {
        compatible = "mxl,cbphy-app-lgm", "syscon";
        reg = <0xd0a00000 0x40000>;
    };
    cb0phy0_app: cbphy-app@d0a40000 {
        compatible = "mxl,cbphy-app-lgm", "syscon";
        reg = <0xd0a40000 0x1000>;
    };
    combophy0:combophy0 {
        compatible = "intel,combo-phy", "simple-bus";
        #address-cells = <1>;
        #size-cells = <1>;
        ranges;
        resets = <&rcu0 0x50 17>, /* Combo */
                 <&rcu0 0x50 6>;  /* PCIe 10/11 PHY */
        reset-names = "combo", "phy";
        clocks = <&cgu0 LGM_CLK_CBPHY0>;
        intel,syscon = <&sysconf>; /* chiptop */
        intel,hsio = <&hsiol>; /* hsiol cbphy0 */
        intel,bid = <0>; /* hsio bus id */
        intel,epu-idx = <1>;
        cb0phy0:cb0phy@0 { /* PCIe 10/XPCS 0/SATA 0 */
            compatible = "intel,cbphy";
            #phy-cells = <1>;
            mxl,cr = <&cb0phy0_cr>;
            mxl,app = <&cb0phy0_app>;
            resets = <&rcu0 0x50 23>,
                     <&rcu0 0x50 12>;
            reset-names = "pcie", "xpcs";
        };
        cb0phy1:cb0phy@1 { /* PCIe 11/XPCS 1/SATA 1 */
            compatible = "intel,cbphy";
            #phy-cells = <1>;
            mxl,cr = <&cb0phy1_cr>;
            mxl,app = <&cb0phy1_app>;
            resets = <&rcu0 0x50 24>,
                     <&rcu0 0x50 13>;
            reset-names = "pcie", "xpcs";
        };
    };
